{
    <% if (typeof hostname !== 'undefined') { -%>
    "hostname": "<%=hostname%>",
    <% } -%>
    "password":
        {
            "crypted": false,
            "text": "<%=rootPassword%>"
        },
    "disk": "<%=installDisk%>",
    "type": "<%=installType%>",
    <% if (typeof rootSshKey !== 'undefined') { -%>
    "public_key": "<%=rootSshKey%>",
    <% } -%>
    "postinstall": [
                    "#!/bin/sh",

                    "# Download the service to callback to RackHD after OS installation/reboot completion",
                    "/bin/curl http://<%=server%>:<%=port%>/api/common/templates/<%=rackhdCallbackScript%> > /etc/<%=rackhdCallbackScript%>",
                    "chmod +x /etc/<%=rackhdCallbackScript%>",

                    "# Generate the service file",
                    "filename=/etc/systemd/system/<%=rackhdCallbackScript%>.service",
                    "echo -e '[Unit]\nDescription=rackhdCallbackScript' > $filename",
                    "echo -e '[Service]\nType=oneshot\nExecStart=/etc/<%=rackhdCallbackScript%>' >> $filename",
                    "echo -e '[Install]\nWantedBy=multi-user.target' >> $filename",

                    "chmod 0644 $filename",

                    "# Install the service",
                    "systemctl enable <%=rackhdCallbackScript%>.service",

                    "# Enable SSH root login",
                    "sed -i 's/PermitRootLogin no/PermitRootLogin yes/g' /etc/ssh/sshd_config",

                    "# Signify ORA the installation completed",
                    "curl http://<%=server%>:<%=port%>/api/common/templates/<%=completionUri%>"
                   ]
}